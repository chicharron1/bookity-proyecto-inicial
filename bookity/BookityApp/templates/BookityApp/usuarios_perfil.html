{% extends 'BookityApp/base.html' %}

{% block content %}
<h1 style="text-align: center; font-family: 'Sour Gummy', sans-serif;font-size:50px;padding-top: 50px;">Perfil de {{ usuario.username }}</h1>
<p><strong>Usuario:</strong> {{ usuario.username }}</p>
<div class="ordenar_perfil_otro">
    <p class="item2"><strong>Nivel:</strong> {{ perfil.nivel_usuario }}</p>
    <p class="item2"><strong>Puntaje:</strong> {{ perfil.puntaje_usuario }}</p>
    
<div class="ordenar_perfil_otro">
    <p class="item2"><strong>Calificación Promedio:</strong>
    {% if perfil.promedio_calificaciones %}
        {{ perfil.promedio_calificaciones|floatformat:2 }}
    {% else %}
        Sin calificaciones aún
    {% endif %}
    </p>
</div>
    {% if usuario != request.user %}
        <form method="post">
            {% csrf_token %}
            {% if siguiendo %}
                <button type="submit" name="accion" value="dejar_de_seguir">Dejar de Seguir</button>
            {% else %}
                <button type="submit" name="accion" value="seguir">Seguir</button>
            {% endif %}
        </form>
    {% endif %}
</div>
<h2 style="text-align: center; font-family: 'inder', sans-serif;">Publicaciones Disponibles</h2>
{% if publicaciones %}
    <div class="contenedor-publicaciones2">
        {% for publicacion in publicaciones %}
            <div class="publicacion">
                <h2>{{ publicacion.titulo }}</h2>
                <p>{{ publicacion.descripcion }}</p>
                <p><em>Publicado el {{ publicacion.fecha_publicacion|date:"d/m/Y H:i" }}</em></p>
                <div>
                    <a href="{% url 'detalle' publicacion.id %}" style="text-decoration: none;color: black;font-weight: bold;">Ver más información</a>
                </div>
                <form method="post" action="{% url 'eliminar_publicacion' publicacion.id %}">
                    {% csrf_token %}
                    <button type="submit">Eliminar Publicación</button>
                </form>
            </div>
        {% endfor %}
    </div>
{% else %}
    <p class="mensaje_sin_pub">No hay publicaciones disponibles</p>
{% endif %}
    <h2 style="text-align: center; font-family: 'inder', sans-serif; margin-top: 40px;">Publicaciones Cerradas</h2>
    {% if publicaciones_cerradas %}
        <div class="scroll-box">
            {% for publicacion in publicaciones_cerradas %}
                <div class="publicacion">
                    <h3>{{ publicacion.titulo }}</h3>
                    <p>{{ publicacion.descripcion|truncatechars:50 }}</p>
                    <p><em>Publicado el {{ publicacion.fecha_publicacion|date:"d/m/Y H:i" }}</em></p>
                    {% if publicacion.calificacion %}
                        <p><strong>Calificación:</strong> {{ publicacion.calificacion }}</p>
                    {% endif %}
                    <div>
                        <a href="{% url 'detalle' publicacion.id %}">Ver más información</a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No hay publicaciones cerradas.</p>
    {% endif %}
{% endblock %}